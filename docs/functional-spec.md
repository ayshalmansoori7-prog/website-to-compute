# المواصفات الوظيفية — لعبة شبيهة بـ Seen Jeem (نسخة محسنة)

الهدف: بناء تجربة لعب شبيهة بـ "Seen Jeem" باللغة العربية وباتجاه RTL مع تحسينات UX، مراعاة قواعد اللعبة، وسائل مساعدة، وتحكمات بسيطة للإدارة.

1) ملخص التدفق العام
- شاشة البداية (محلية): تسجيل/دخول مخزّن محليًا في `localStorage`، ثم شاشة إنشاء الفرق.
- إعداد اللعبة: إدخال اسمي الفريقين + اختيار 1-6 فئات من جدول الفئات.
- لوحة اللعبة: شبكة من الفئات (بطاقات) تحتوي على أزرار نقاط لكل فئة (200,400,600,800).
- اختيار قيمة: الفريق الحالي يختار بطاقة نقطة. يظهر السؤال في اللوحة الجانبية مع مؤقت.
- أثناء سؤال: يوجد زران للمساعدة — "تلميح" (مرة لكل فريق/جولة) و"استعن بصديق" (مرة لكل فريق/جولة، 90s).
- انتهاء المؤقت أو اختيار انتهاء النقاش: تظهر واجهة "نسب الإجابة" (من أجاب؟ فريق1، فريق2، لا أحد).
- بعد النسبة: تُمنح النقاط، تُعلَّم الخانة كمُجابة، يتبدل الدور، وتكرر حتى تنفد الأسئلة.
- النهاية: عرض النتائج النهائية وبطاقة الفائز.

2) الشاشات + مكونات UI
- Home / Auth (محلي): حقول بسيطة، خيار لغة مخفي لأن التطبيق كله عربي.
- Setup Modal: حقول `team1Name`, `team2Name`, قائمة اختيار الفئات (checkbox list)، زر "ابدأ".
- Game Header: أسماء الفرق، النقاط، مؤشر الدور الحالي.
- Categories Grid: بطاقة لكل فئة تُظهر الاموجي والاسم العربي، وأزرار نقاط 4.
- Question Panel (sticky): تفاصيل الفئة، مستوى الصعوبة، نقاط، نص السؤال، مؤقت، أزرار المساعدة، واجهة النسب.
- Modals: تلميح، استعن بصديق مع عدّاد، تحذيرات.
- Game Over: ملخص النقاط وفرص إعادة اللعب.

3) قواعد اللعب (مطابقة لـ Seen Jeem، مع تحسينات)
- كل فئة: 4 مستويات نقاط (200/400/600/800).
- سؤال واحد لكل مستوى (يمكن توسيع لاحقًا إلى حسابات أكثر)؛ بمجرد أن تُعَلَّم، لا يمكن اختياره مجددًا.
- الدور ينتقل بعد إتمام نسبة الإجابة (تلقائيًا بعد الحسم أو بعد مهلة افتراضية).
- مهلة اختيار من يجاوب (نسبة): إذا لم يُحدد أحد خلال 6 ثوانٍ، تُعتبر "لا أحد" تلقائيًا.
- تلميح: متاح مرة واحدة لكل فريق في كل جولة/دورة (قابل للتخصيص لاحقًا).
- استعن بصديق: مرة واحدة لكل فريق في كل جولة، يفتح مودال مع عدّاد 90s.
- مفاجآت: (مستقبلًا) أسئلة مفاجئة ذات نقاط خاصة أو تأثيرات.

4) إدارة الأسئلة والبيانات
- نموذج بيانات الفئات: `categoriesPointsTable` (id, name,nameAr,emoji,points[],difficulties[]).
- قاعدة الأسئلة: JSON قابلة للاستيراد؛ API محلي في المستقبل.
- مصفوفة تتبع الإجابات: Set من المفاتيح `"categoryId-pointIndex"`.
- الحفظ المحلي: جلسة اللعبة (أسماء الفرق، النقاط، الأسئلة المعلّمة) تحفظ مؤقتًا في `localStorage` أثناء اللعب.

5) حالات حافة/تحقق
- اختيار فئة مكررة: منع/تعطيل الزر.
- محاولة استخدام المساعدة بعد استهلاكها: تعطيل الزر وإظهار رسالة صغيرة.
- انتهاء المؤقت: تشغيل واجهة النسبة تلقائياً.
- استرجاع صفحة أثناء منتصف السؤال: إن وُجد حفظ محلي، استئناف الحالة (لاحقًا).

6) تحسينات UX المقترحة
- رسوم انتقال ناعمة عند فتح السؤال/إغلاقه.
- إشارة بصرية واضحة للفريق النشط.
- صوت اختياري للمزامنة (العد التنازلي يرن عند 10 ثوانٍ).
- إظهار سجل الأسئلة/الإجابات لإعادة العرض.

7) خارطة العمل المباشرة (خطوات قادمة لهذه المهمة)
- ا. توثيق كامل لشاشات التحكم (سأنتج wireframe HTML وملف CSS تجريبي).
- ب. دمج المنطق إلى `engine.js` (تحويل تدريجي، حالياً قمت بتغليف الواجهات في `Engine`).
- ج. تعديل `game.html` ليستدعي `Engine.*` تدريجيًا وإزالة التعقيدات المكررة.
- د. تجربة محلية عبر تشغيل الخادم (`npm run dev` أو فتح الملف في المتصفح) وإصلاح الأخطاء.

---

ملحوظة: هذه المواصفات قابلة للتوسعة (تفصيل كل شاشة بعناصرها وبيانات الاختبار). أخبرني إن أردت أن أبدأ فورًا بكتابة مواصفات تفصيلية لكل شاشة (نماذج الحقول، أحداث DOM، وأمثلة للـ JSON لقاعدة الأسئلة).